id: O365-SecurityAndCompliance-Test
version: -1
name: O365-SecurityAndCompliance-Test
description: This playbook test SecurityAndCompliance integration
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 922e85fa-54f0-477f-8e31-92c2037c444c
    type: start
    task:
      id: 922e85fa-54f0-477f-8e31-92c2037c444c
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: aa8f7b40-313d-4a8a-8e18-9548ad95205c
    type: regular
    task:
      id: aa8f7b40-313d-4a8a-8e18-9548ad95205c
      version: -1
      name: Create content search
      description: Create new compliance search in the Security & Compliance Center.
      script: '|||o365-sc-new-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      allow_not_found_exchange_locations:
        simple: "true"
      case: {}
      description:
        complex:
          root: inputs.description
      exchange_location:
        complex:
          root: inputs.exchange_location
      exchange_location_exclusion: {}
      kql:
        complex:
          root: inputs.kql
      public_folder_location: {}
      search_name:
        complex:
          root: inputs.search_name
      share_point_location: {}
      share_point_location_exclusion: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 60e554ad-867b-4268-8bbf-ac5b5408c80b
    type: condition
    task:
      id: 60e554ad-867b-4268-8bbf-ac5b5408c80b
      version: -1
      name: Validate !o365-sc-new-search command
      description: 'Validate compliance search creation with all additional arguments. '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.Search.AllowNotFoundExchangeLocationsEnabled
            iscontext: true
          right:
            value:
              simple: "true"
      - - operator: isEqualString
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.Search.Description
            iscontext: true
          right:
            value:
              simple: Demisto description
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.Search.ExchangeLocation
            iscontext: true
          right:
            value:
              simple: avishai@demistodev.onmicrosoft.com
      - - operator: isEqualString
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.Search.ContentMatchQuery
            iscontext: true
          right:
            value:
              simple: Rodrigo
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 29d0722f-2557-4212-816a-56f28df5289f
    type: regular
    task:
      id: 29d0722f-2557-4212-816a-56f28df5289f
      version: -1
      name: Remove search
      description: Remove compliance search by name from the Security & Compliance
        Center.
      script: '|||o365-sc-remove-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      search_name:
        complex:
          root: inputs.search_name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 725,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 6d4b793f-5907-4fe7-8d40-8af283b7c5b6
    type: regular
    task:
      id: 6d4b793f-5907-4fe7-8d40-8af283b7c5b6
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 6e6ab1b2-1bdb-4292-8691-adaff7924547
    type: regular
    task:
      id: 6e6ab1b2-1bdb-4292-8691-adaff7924547
      version: -1
      name: Get search
      description: Get compliance search from the Security & Compliance Center.
      script: '|||o365-sc-get-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all_results: {}
      export: {}
      limit: {}
      search_name:
        complex:
          root: inputs.search_name
      statistics: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: b4b4d7a1-5082-4e96-8fd0-10b52af35b4c
    type: condition
    task:
      id: b4b4d7a1-5082-4e96-8fd0-10b52af35b4c
      version: -1
      name: Validate !o365-sc-get-search and !o365-sc-set-search commands
      description: 'Validate compliance search modified with all additional arguments. '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "7"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: notContainsGeneral
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.Search.ExchangeLocation
            iscontext: true
          right:
            value:
              simple: notexists@demistodev.onmicrosoft.com
    view: |-
      {
        "position": {
          "x": 280,
          "y": 1250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: f68ca5a8-1ad7-4f09-81ee-2a49cb0bb292
    type: regular
    task:
      id: f68ca5a8-1ad7-4f09-81ee-2a49cb0bb292
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: ee4ff3db-5e90-4e55-852a-e67fd020f831
    type: regular
    task:
      id: ee4ff3db-5e90-4e55-852a-e67fd020f831
      version: -1
      name: List search
      description: List compliance searches in the Security & Compliance Center.
      script: '|||o365-sc-list-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "9":
    id: "9"
    taskid: fff129bf-7d42-4f76-82db-9b04b025b067
    type: condition
    task:
      id: fff129bf-7d42-4f76-82db-9b04b025b067
      version: -1
      name: Validate !o365-sc-list-search command
      description: 'Validate compliance search list. '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.Search.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: e6f804ef-564a-41da-84eb-4857067eb386
    type: regular
    task:
      id: e6f804ef-564a-41da-84eb-4857067eb386
      version: -1
      name: Remove search
      description: Remove compliance search by name from the Security & Compliance
        Center.
      script: '|||o365-sc-remove-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      search_name:
        complex:
          root: inputs.search_name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: d5bb7834-9426-4672-8d12-85a2b40ccfcd
    type: regular
    task:
      id: d5bb7834-9426-4672-8d12-85a2b40ccfcd
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 04486033-f738-407a-868e-11fb19d2635d
    type: playbook
    task:
      id: 04486033-f738-407a-868e-11fb19d2635d
      version: -1
      name: O365 - Security And Compliance - Search Start
      description: This playbook intend to start search in security and compliance
        and than wait to search to complete.
      playbookName: O365 - Security And Compliance - Search Start
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      search_name:
        complex:
          root: inputs.search_name
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 490,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: c6dbbbd4-10e2-413f-80de-a19da79e1795
    type: regular
    task:
      id: c6dbbbd4-10e2-413f-80de-a19da79e1795
      version: -1
      name: Get search
      description: Get compliance search by name from the Security & Compliance Center.
      script: '|||o365-sc-get-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      all_results:
        simple: "true"
      export: {}
      limit: {}
      search_name:
        complex:
          root: inputs.search_name
      statistics:
        simple: "true"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 490,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: c26e06b9-0877-4df6-8316-56ed20f81155
    type: condition
    task:
      id: c26e06b9-0877-4df6-8316-56ed20f81155
      version: -1
      name: Validate !o365-sc-start-search (Generic polling playbook)
      description: 'Validate compliance search completed after start in generic polling  with
        all additional arguments. '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.Search.SuccessResults
            iscontext: true
    view: |-
      {
        "position": {
          "x": 490,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "16":
    id: "16"
    taskid: e3b4d582-607c-4f39-87ec-96f33365ae4c
    type: regular
    task:
      id: e3b4d582-607c-4f39-87ec-96f33365ae4c
      version: -1
      name: PrintErrorEntry
      description: Prints an error entry with a given message
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Fail executing test playbook
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: 948156ea-2241-4b1a-8043-3daa9b1384c9
    type: playbook
    task:
      id: 948156ea-2241-4b1a-8043-3daa9b1384c9
      version: -1
      name: O365 - Security And Compliance - Search Action
      description: This playbook intend to create new search action in security and
        compliance and than wait to search action to complete.
      playbookName: O365 - Security And Compliance - Search Action
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      purge_type: {}
      search_action:
        simple: Preview
      search_name:
        complex:
          root: inputs.search_name
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 715,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: 51786913-7077-4a2e-8b07-4ad49e62a3b4
    type: condition
    task:
      id: 51786913-7077-4a2e-8b07-4ad49e62a3b4
      version: -1
      name: Validate !o365-sc-new-search-action (Generic polling playbook) and !o365-sc-get-search-action
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.SearchAction.Results
            iscontext: true
    view: |-
      {
        "position": {
          "x": 715,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: a252078d-69bd-4aa8-8e01-8b2b0f0668ba
    type: regular
    task:
      id: a252078d-69bd-4aa8-8e01-8b2b0f0668ba
      version: -1
      name: Get search action
      description: Get compliance search action from the Security & Compliance Center.
      script: '|||o365-sc-get-search-action'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      export: {}
      limit: {}
      results:
        simple: "true"
      search_action_name:
        complex:
          root: O365.SecurityAndCompliance.ContentSearch.SearchAction.Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 715,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: fbcb788a-ff9a-464d-8cba-b0344fdbf5a4
    type: regular
    task:
      id: fbcb788a-ff9a-464d-8cba-b0344fdbf5a4
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 715,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 6158e741-0bc4-4389-86a5-c8fe4919efaa
    type: regular
    task:
      id: 6158e741-0bc4-4389-86a5-c8fe4919efaa
      version: -1
      name: List search actions
      description: List compliance search actions from the Security & Compliance Center.
      script: '|||o365-sc-list-search-action'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: 60682648-d4a9-4f24-879d-50775b1bce5c
    type: condition
    task:
      id: 60682648-d4a9-4f24-879d-50775b1bce5c
      version: -1
      name: Validate !o365-sc-list-search-action command
      description: 'Validate compliance search actions list. '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "10"
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.SearchAction
            iscontext: true
    view: |-
      {
        "position": {
          "x": 602.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 29bc3412-fcdd-4ac9-8a3a-f858109c0bf5
    type: regular
    task:
      id: 29bc3412-fcdd-4ac9-8a3a-f858109c0bf5
      version: -1
      name: Remove search action
      description: Remove compliance search action by search action name from the
        Security & Compliance Center.
      script: '|||o365-sc-remove-search-action'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      search_action_name:
        complex:
          root: O365.SecurityAndCompliance.ContentSearch.SearchAction.Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 725,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "24":
    id: "24"
    taskid: bce5b6b0-cc1f-4fa2-8232-43d4197b6210
    type: regular
    task:
      id: bce5b6b0-cc1f-4fa2-8232-43d4197b6210
      version: -1
      name: Stop search
      description: Stop running compliance search in the Security & Compliance Center.
      script: '|||o365-sc-stop-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      search_name:
        complex:
          root: inputs.search_name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 725,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: b7411ed7-13db-4e55-8598-22932a70959b
    type: regular
    task:
      id: b7411ed7-13db-4e55-8598-22932a70959b
      version: -1
      name: Set search
      description: Modify non-running compliance search in the Security & Compliance
        Center.
      script: '|||o365-sc-set-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      add_exchange_location: {}
      add_exchange_location_exclusion: {}
      add_public_folder_location: {}
      add_share_point_location: {}
      add_share_point_location_exclusion: {}
      allow_not_found_exchange_locations:
        simple: "false"
      description: {}
      kql: {}
      remove_exchange_location:
        simple: notexists@demistodev.onmicrosoft.com
      remove_exchange_location_exclusion: {}
      remove_public_folder_location: {}
      remove_share_point_location: {}
      remove_share_point_location_exclusion: {}
      search_name:
        complex:
          root: inputs.search_name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: 2a909700-153c-4d37-8d48-89a7bc1164fe
    type: condition
    task:
      id: 2a909700-153c-4d37-8d48-89a7bc1164fe
      version: -1
      name: Check if search action created
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: O365.SecurityAndCompliance.ContentSearch.SearchAction.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 80dc1fa4-fa7e-455b-8e53-ab5f336698c6
    type: regular
    task:
      id: 80dc1fa4-fa7e-455b-8e53-ab5f336698c6
      version: -1
      name: Remove search action
      description: Remove compliance search action by search action name from the
        Security & Compliance Center.
      script: '|||o365-sc-remove-search-action'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      search_action_name:
        complex:
          root: O365.SecurityAndCompliance.ContentSearch.SearchAction.Name
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 295,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: 6f3c2274-5dbc-425e-8393-f7715aff3cd0
    type: regular
    task:
      id: 6f3c2274-5dbc-425e-8393-f7715aff3cd0
      version: -1
      name: Remove existing search test
      description: Remove existing compliance search from the Security & Compliance
        Center.
      script: '|||o365-sc-remove-search'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      search_name:
        complex:
          root: inputs.search_name
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: 140859c0-8b5b-4c01-82ec-0732790ad128
    type: title
    task:
      id: 140859c0-8b5b-4c01-82ec-0732790ad128
      version: -1
      name: Test playbook finished successfully
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 725,
          "y": 4235
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 4265,
        "width": 1055,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: search_name
  value:
    simple: Demisto-Test
  required: true
  description: The name of the compliance search.
  playbookInputQuery:
- key: kql
  value:
    simple: Rodrigo
  required: true
  description: Text search string or a query that's formatted by using the Keyword
    Query Language (KQL).
  playbookInputQuery:
- key: description
  value:
    simple: Demisto description
  required: true
  description: Description for the compliance search.
  playbookInputQuery:
- key: allow_not_found_exchange_locations
  value:
    simple: "true"
  required: true
  description: Whether to include mailboxes other than regular user mailboxes in the
    compliance search.
  playbookInputQuery:
- key: exchange_location
  value:
    simple: avishai@demistodev.onmicrosoft.com,notexists@demistodev.onmicrosoft.com
  required: true
  description: Mailboxes/distribution group to include, or you can use the value "All"
    to include all. (Comma seprated)
  playbookInputQuery:
outputs: []
fromversion: 5.5.0
tests:
- O365-SecurityAndCompliance-Test
